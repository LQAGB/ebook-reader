<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>阅读 - <%= filename %></title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/reader.css">
    <!-- 使用本地资源 -->
    <script src="/lib/pdf.js/pdf.min.js"></script>
    <script src="/lib/jszip/jszip.min.js"></script>
    <script src="/lib/epub.js/epub.min.js"></script>
</head>
<body>
    <div class="reader-container">
        <header class="reader-header">
            <nav class="reader-nav">
                <a href="/library" class="nav-link">
                    <svg class="back-icon" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                    返回图书馆
                </a>
                <h1 class="book-title"><%= filename.split('.')[0] %></h1>
            </nav>
            <div class="reader-controls">
                <button id="prev-btn" class="control-btn">上一页</button>
                <span id="page-info">页码: <span id="current-page">1</span> / <span id="total-pages">-</span></span>
                <button id="next-btn" class="control-btn">下一页</button>
            </div>
        </header>

        <main class="reader-main">
            <div id="sidebar" class="sidebar">
                <div class="sidebar-header">
                    <h3>目录</h3>
                    <button id="toggle-sidebar" class="toggle-btn">
                        <svg viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                        </svg>
                    </button>
                </div>
                <div id="toc" class="toc"></div>
            </div>

            <div id="reader-content" class="reader-content">
                <div id="viewer"></div>
            </div>
        </main>
    </div>

    <script>
        const book = JSON.parse('<%- JSON.stringify(book) %>');
        const fileExt = book.file_type;
        const filePath = `/books/${book.file_name}`;
    </script>
    <script src="/js/reader.js"></script>
</body>
</html> 